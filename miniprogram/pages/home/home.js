// pages/home/home.js

Page({

  // é¡µé¢çš„åˆå§‹æ•°æ®
  data: {
    // ä½¿ç”¨è¯´æ˜æ–‡æœ¬
    article_cn_tea: "",
    article_cn_stu: "",
    article_en_tea: "",
    article_en_stu: "",
    
    // å½“å‰å‡†å¤‡ç¦ç”¨/å¯ç”¨çš„å…ƒç´ çš„çŠ¶æ€
    statu: "",

    // æ§åˆ¶ç¦ç”¨æŒ‰é’®çš„æ˜¯å¦å¯ä½¿ç”¨(disable)çŠ¶æ€
    disable: true,

    // å­˜å‚¨è¢«é€‰ä¸­çš„ç¦ç”¨/å¯ç”¨æ—¥æœŸ
    selectBanDay: "",

    // å­˜å‚¨è¢«é€‰ä¸­çš„ç¦ç”¨/å¯ç”¨æ—¥æœŸç´¢å¼•
    selectBanTimeIndex: -1,

    // å­˜å‚¨è¢«é€‰ä¸­çš„ç¦ç”¨/å¯ç”¨æ—¶æ®µ
    selectBanTime: "",

    // ç”¨äºæ§åˆ¶å±•ç¤ºâ€œä½¿ç”¨è¯´æ˜â€å¼¹çª—
    show: false,

    // å­˜å‚¨ç”¨æˆ·å§“å
    userName: "",

    // å­˜å‚¨é€‰æ‹©æ•™å¸ˆæ—¶ç”¨çš„æ•™å¸ˆåˆ—è¡¨
    teacherArray: [],

    // å­˜å‚¨æ•™å¸ˆåŠå…¬å®¤åˆ—è¡¨â€”â€”ä¸­æ–‡ï¼ˆç´¢å¼•å¯¹åº”ï¼‰
    teacherPlace_zh: [],

    // å­˜å‚¨æ•™å¸ˆåŠå…¬å®¤åˆ—è¡¨â€”â€”è‹±æ–‡ï¼ˆç´¢å¼•å¯¹åº”ï¼‰
    teacherPlace_en: [],

    // å­˜å‚¨è¢«é€‰æ‹©çš„æ•™å¸ˆåœ¨åˆ—è¡¨ä¸­çš„ç´¢å¼•
    index: 0,

    // å­˜å‚¨ä¿¡æ¯è¡¨å†…çš„ä¿¡æ¯
    tableData: [],

    // å­˜å‚¨ä¿¡æ¯è¡¨çš„è¡¨å¤´
    headerData: [],

    // å­˜å‚¨æ¥è‡ªæ•°æ®åº“çš„æ‰€æœ‰æ—¶é—´è¡¨ä¿¡æ¯
    totalTimeTable:[],
    
    // è¯­è¨€è®¾ç½®ï¼Œzh_cnä¸º1ï¼Œenä¸º0
    language: 0, 

    // æƒé™ç­‰çº§
    credit: 1,
  },

  // bindBanOrAllow ç‚¹å‡»ç¦ç”¨/å¯ç”¨æ­¤æ—¶é—´æ®µæŒ‰é’®åçš„è§¦å‘å‡½æ•°
  // è´Ÿè´£å°†å˜æ›´çš„çŠ¶æ€æ•°æ®ä¸Šä¼ åˆ°äº‘ç«¯
  bindBanOrAllow: function(e){
    if (this.data.statu === "âš«ï¸"){
      wx.cloud.callFunction({
        name: "banTime",
        data: {
          // è¢«é€‰ä¸­çš„æ—¥æœŸä¸æ—¶é—´
          date: this.data.selectBanDay,
          time: this.data.selectBanTime,
          type: 1 // è®¾ç½®ä¸ºå¯ç”¨
        },
        success:res => {
          // é‡æ–°åŠ è½½æ—¶é—´è¡¨
          this.getTableDataBase()
          console.log("å·²ç»è®¾ç½®ä¸ºå¯ç”¨çŠ¶æ€å®Œæˆ")
        },
        fail:err => {
          this.getTableDataBase()
          console.log("è®¾ç½®å¯ç”¨çŠ¶æ€å¼‚å¸¸ä¸­æ­¢")
        }
      })
    }
    else if (this.data.statu === "âœ…"){
      wx.cloud.callFunction({
        name: "banTime",
        data: {
          // è¢«é€‰ä¸­çš„æ—¥æœŸä¸æ—¶é—´
          date: this.data.selectBanDay,
          time: this.data.selectBanTime,
          type: 0 // è®¾ç½®ä¸ºç¦ç”¨
        },
        success:res => {
          // é‡æ–°åŠ è½½æ—¶é—´è¡¨
          this.getTableDataBase()
          console.log("å·²ç»è®¾ç½®ä¸ºç¦ç”¨çŠ¶æ€å®Œæˆ")
        },
        fail:err => {
          this.getTableDataBase()
          console.log("è®¾ç½®ç¦ç”¨çŠ¶æ€å¼‚å¸¸ä¸­æ­¢")
        }
      })
    }
    else{
      console.log("ç¦ç”¨/å¯ç”¨å¤±è´¥")
    }
  },

  // goAppointment ç‚¹å‡»é¢„çº¦æ­¤æ—¶é—´æ®µæŒ‰é’®åçš„è§¦å‘å‡½æ•°
  // è·³è½¬è‡³å¯¹åº”çš„ç•Œé¢å¹¶ä¸”é¡µé¢ä¼ å‚
  goAppointment: function(e){
    var that = this
    var selectDay = that.data.selectBanDay
    var selectTime = that.data.selectBanTime
    console.log(selectDay)
    console.log(selectTime)
    var selectTeacher = that.data.teacherArray[that.data.index]
    console.log(selectTeacher)
    // å¤„äºğŸŸ¡å’Œâœ…çš„æ—¶é—´æ®µä¸ºå¯é¢„çº¦æ—¶é—´æ®µ
    if (this.data.statu === "ğŸŸ¡" || this.data.statu === "âœ…"){
      // è·³è½¬è‡³appointmentç•Œé¢ä¸”ä¼ å‚ï¼ˆé€‰ä¸­çš„æ—¥æœŸï¼Œæ—¶é—´å’Œæ•™å¸ˆï¼‰
      wx.navigateTo({
      url: "../appointment/appointment?Day="+encodeURIComponent(selectDay)+"&Time="+encodeURIComponent(selectTime)+"&Teacher="+encodeURIComponent(selectTeacher)
      })
    }
    else{
      console.log("é¢„çº¦æŒ‰é’®è·³è½¬å¤±è´¥")
    }
  },

  // ç‚¹å‡»æŸ¥çœ‹æ­¤æ—¶é—´æ®µæŒ‰é’®åçš„è§¦å‘å‡½æ•°
  // è·³è½¬è‡³å¯¹åº”çš„ç•Œé¢
  goAppointmentList: function(e){
    wx.reLaunch({
      // ä½¿ç”¨wx.reLaunchçš„apiè·³è½¬åˆ°tabBarç•Œé¢
      url: "../appointmentList/appointmentList"
    }) 
  },
  
  // å½“é€‰æ‹©æ•™å¸ˆåè§¦å‘çš„å‡½æ•°
  // è®¾ç½®é€‰ä¸­çš„æ•™å¸ˆä¸”åˆ›å»ºæ—¶é—´è¡¨
  bindPickerChange: function(e){
    console.log("å·²é€‰æ‹©æ•™å¸ˆï¼Œåœ¨æ•™å¸ˆæ•°ç»„ç´¢å¼•ä¸º",e.detail.value)
    // è®¾ç½®indexä¸ºé€‰æ‹©çš„æ•™å¸ˆåœ¨æ•™å¸ˆæ•°ç»„ä¸­å¯¹åº”çš„ç´¢å¼•
    this.setData({
      index: e.detail.value
    })
    this.createTable() // æŒ‰ç…§æ•°æ®åº“ä¿¡æ¯åˆ›å»ºæ—¶é—´è¡¨
  },

  // å½“æ•™å¸ˆç‚¹å‡»è¡¨ä¸­å…ƒç´ æ—¶å¯ç”¨
  // ç”¨äºç¡®è®¤é€‰ä¸­çš„æ•™å¸ˆï¼Œæ—¥æœŸå’Œæ—¶é—´ï¼ŒåŒæ—¶åˆ¤æ–­æ˜¯å¦å¯ä»¥ç¦ç”¨
  getSelcet: function(e){
    console.log(e.detail)
    this.setData({
      selectBanDay: e.detail.label,
      selectBanTime: e.detail.item.times,
      selectBanTimeIndex: e.detail.line
    })
    for (var i = 0; i < this.data.tableData.length; i++){
      if (i === this.data.selectBanTimeIndex){
        for (var key in this.data.tableData[i]){
          if (key === this.data.selectBanDay){
            // æŸ¥è¯¢æ•™å¸ˆæ‰€ç‚¹ä¸‹çš„å…ƒç´ ï¼Œå¹¶ä¸”è¯†åˆ«å…¶çŠ¶æ€
            var statu_temp = this.data.tableData[i][key]
            if (statu_temp === "âš«ï¸"){
              this.setData({
                disable: false // è§£é™¤æŒ‰é’®ç¦ç”¨
              })
            }
            else if (statu_temp === "âœ…"){
              this.setData({
                disable: false
              })
            } 
            else if (statu_temp === "ğŸŸ¡"){
              this.setData({
                disable: true // å¼€å¯æŒ‰é’®ç¦ç”¨
              })
            }
            else if (statu_temp === "â›”"){
              this.setData({
                disable: true
              })
            }
            else {
              console.log("å½“å‰å…ƒç´ ä¸æ˜")
            }
          }
        }
      }
    }
    this.setData({
      statu: statu_temp // å°†å½“å‰é€‰ä¸­çš„æ—¶é—´æ®µçš„çŠ¶æ€æš‚å­˜
    })
  },

  // å½“å­¦ç”Ÿç‚¹å‡»è¡¨ä¸­å…ƒç´ è¿›è¡Œé¢„çº¦æ—¶è°ƒç”¨
  // ç”¨äºç¡®è®¤é€‰ä¸­çš„æ•™å¸ˆï¼Œæ—¥æœŸå’Œæ—¶é—´ï¼ŒåŒæ—¶åˆ¤æ–­æ˜¯å¦å¯ä»¥è·³è½¬é¢„çº¦
  getSelcet_student: function(e){
    console.log(e.detail)
    this.setData({
      selectBanDay: e.detail.label,
      selectBanTime: e.detail.item.times,
      selectBanTimeIndex: e.detail.line
    })
    for (var i = 0; i < this.data.tableData.length; i++){
      if (i === this.data.selectBanTimeIndex){
        for (var key in this.data.tableData[i]){
          if (key === this.data.selectBanDay){
            // æŸ¥è¯¢å­¦ç”Ÿæ‰€ç‚¹ä¸‹çš„å…ƒç´ ï¼Œå¹¶ä¸”è¯†åˆ«å…¶çŠ¶æ€
            var statu_temp = this.data.tableData[i][key]
            if (statu_temp === "âš«ï¸"){
              this.setData({
                disable: true // é¢„çº¦æŒ‰é’®ä¸å¯äº¤äº’
              })
            }
            else if (statu_temp === "âœ…"){
              this.setData({
                disable: false // é¢„çº¦æŒ‰é’®å¯ä»¥äº¤äº’
              })
            } 
            else if (statu_temp === "ğŸŸ¡"){
              this.setData({
                disable: false
              })
            }
            else if (statu_temp === "â›”"){
              this.setData({
                disable: true
              })
            }
            else {
              console.log("å½“å‰å…ƒç´ ä¸æ˜")
            }
          }
        }
      }
    }
    this.setData({
      statu: statu_temp // å°†å½“å‰é€‰ä¸­çš„æ—¶é—´æ®µçš„çŠ¶æ€æš‚å­˜
    })
  },

  // æŒ‰ç…§æ—¶é—´è¡¨ä¿¡æ¯åˆ›å»ºæ—¶é—´è¡¨
  // åŸºæœ¬åœ¨getTableDataBaseå‡½æ•°ä¸­è¢«è°ƒç”¨ï¼ŒåŸºäºæœ€æ–°çš„ä¿¡æ¯åˆ›å»ºæ—¶é—´è¡¨
  createTable: function(){
    var sourceTableData = this.data.totalTimeTable[this.data.index] // ç”¨äºæš‚æ—¶ä¿å­˜å½“å‰é€‰æ‹©æ•™å¸ˆçš„æ—¶é—´è¡¨
    console.log(this.data.totalTimeTable)
    // temp_headerDataç”¨äºæš‚æ—¶å­˜å‚¨å‡†å¤‡ç”¨äºæ¸²æŸ“çš„headerDataï¼Œä¸‹é¢æ˜¯å¯¹æ•°æ®çš„å¤„ç†
    var temp_headerData = [{
      prop: "times",
      label: "Times",
    }]
    for (var i = 0; i < sourceTableData.headerDate.length; i++){
      temp_headerData.push({
        prop: sourceTableData.headerDate[i],
        label: sourceTableData.headerDate[i],
      })
    }
    // è®¾ç½®ç”¨äºæ¸²æŸ“çš„headerDataæ•°æ®
    this.setData({
      headerData: temp_headerData
    })
    // temp_tableDataç”¨äºæš‚æ—¶å­˜å‚¨å‡†å¤‡ç”¨äºæ¸²æŸ“çš„headerDataï¼Œä¸‹é¢æ˜¯å¯¹æ•°æ®çš„å¤„ç†
    var temp_tableData = []
    for (var i = 0; i < sourceTableData.tableDate.length; i++){ // ç¬¬ä¸€é‡éå†ï¼Œç¡®å®šæ˜¯ç¬¬å‡ è¡Œçš„æ•°æ®
      var temp_eachTableData = {times: sourceTableData.tableDate[i].time} // tableDataä¸­çš„æ¯ä¸ªå¯¹è±¡
      for (var j = 0; j < sourceTableData.tableDate[i].status.length; j++){ //ç¬¬äºŒé‡éå†ï¼Œç¡®å®šstatuså­˜å‚¨çš„çŠ¶æ€æ•°å­—
          var temp_key = sourceTableData.headerDate[j]
          temp_eachTableData[temp_key] = this.getEmoji(sourceTableData.tableDate[i].status[j])
          // é€šè¿‡getEmojiå°†çŠ¶æ€æ•°å­—è½¬ä¸ºçŠ¶æ€Emoji
      }  
      temp_tableData.push(temp_eachTableData) // å°†æœ¬è¡Œæ•°æ®æ·»åŠ åˆ°temp_tableData
    }

    // è®¾ç½®ç”¨äºæ¸²æŸ“çš„headerDataæ•°æ®
    this.setData({
      tableData: temp_tableData
    })
  },

  // å°†data.totalTimeTableä¸­çš„çŠ¶æ€æ•°å­—ä¿®æ”¹ä¸ºæ˜¾ç¤ºç”¨çš„emoji
  getEmoji: function(statu){
    if (statu === 0){
      return "âš«ï¸"
    }
    else if (statu === 1){
      return "âœ…"
    }
    else if (statu === 2){
      return "ğŸŸ¡"
    }
    else if(statu === 3){
      return "â›”"
    }
    else{
      return "N/A" // ç‰¹æ®Šæƒ…å†µï¼Œå¤„ç†é”™è¯¯æ•°æ®
    }
  },

  // è°ƒç”¨äº‘å‡½æ•°ï¼Œè·å–æ•°æ®åº“çš„æ—¶é—´è¡¨ç›¸å…³ä¿¡æ¯
  // åŒæ—¶ä¹Ÿç”¨äºå®ç°åŠ è½½å›¾æ ‡ï¼Œé€šè¿‡wxwx.showLoading
  getTableDataBase: function(){
    wx.showLoading({
      title: 'Loading'
    })
    // è·å–æ•™å¸ˆåˆ—è¡¨ä¸æ—¶é—´è¡¨ä¿¡æ¯
    wx.cloud.callFunction({
      name: "getTableInfo",
      success:res=>{
        var teacherList_temp = res.result.teacherList
        console.log(res)
        var teacherArray = Array.from(teacherList_temp,({Name})=>Name)
        var teacherPlace_zh = Array.from(teacherList_temp,({zh_cn_place})=>zh_cn_place)
        var teacherPlace_en = Array.from(teacherList_temp,({en_place})=>en_place)
        // åˆ›å»ºä¸‰ä¸ªæ•°ç»„ï¼Œç”¨äºå­˜å‚¨æ•™å¸ˆåå­—æ•°ç»„ï¼Œæ•™å¸ˆåŠå…¬å®¤åœ°å€ä¸­æ–‡ï¼Œæ•™å¸ˆåŠå…¬å®¤åœ°å€è‹±æ–‡ï¼Œä½¿ç”¨æ•°ç»„çš„fromæ–¹æ³•
        this.setData({
          // è®¾ç½®æ•™å¸ˆåå­—åˆ—è¡¨
          teacherArray: teacherArray,

          // è®¾ç½®æ•™å¸ˆåŠå…¬å®¤åˆ—è¡¨ä¸­æ–‡
          teacherPlace_zh: teacherPlace_zh,

          // è®¾ç½®æ•™å¸ˆåŠå…¬å®¤åˆ—è¡¨è‹±æ–‡
          teacherPlace_en: teacherPlace_en,

          // å±•å¼€è¡¨è¾¾å¼è®¾ç½®ä¿å­˜æ•™å¸ˆæ—¶é—´è¡¨
          totalTimeTable: [...res.result.timeList],
          // åç«¯å·²ç»ç¡®ä¿teacherArrayå’ŒtotalTimeTableçš„ç´¢å¼•ä¸€ä¸€å¯¹åº”
        })
        try{
          var temp_name = wx.getStorageSync("Name")
          this.setData({
            userName: temp_name
          })
        }catch(e){
          console.log("å§“åè·å–é”™è¯¯")
        }
        // è‹¥ç™»å½•äººä¸ºæ•™å¸ˆï¼Œæ›´æ”¹ä¸ºæ•™å¸ˆå¯¹åº”çš„this.data.indexï¼Œä»¥ç¡®ä¿åˆå§‹åŒ–æ­£ç¡®
        if (this.data.credit === 2 || this.data.credit === 4){
          for (var i = 0; i < this.data.teacherArray.length; i++){
            if (this.data.teacherArray[i] === this.data.userName){
              this.setData({
                index: i
              })
            }
          }
        }
        this.createTable() // ç”±äºå¼‚æ­¥çš„åŸå› ï¼Œè¿™é‡Œåº”å½“æ”¾åœ¨å›è°ƒå‡½æ•°é‡Œé¢
        wx.hideLoading() //åŠ è½½ä¸­å›¾æ ‡ç»“æŸ
      },
      fail:err=>{
        console.log(err)
        console.log("è·å–æ•°æ®åº“ä¿¡æ¯é”™è¯¯")
      }
    })
  },

  // å½“ä»»ä½•æƒé™ç‚¹å‡»ä½¿ç”¨è§„åˆ™åæ‰§è¡Œçš„å‡½æ•°
  getRules(){
    this.showPopup()
  },

  // å±•ç¤ºPop_upå¼¹çª—
  showPopup(){
    this.setData({
      show: true
    })
  },

  // å…³é—­Pop_upå¼¹çª—
  closePopup(){
    this.setData({
      show: false
    })
  },

  // è®¾ç½®è¯­è¨€æ–‡æœ¬
  // å°†è¯­è¨€æ–‡æœ¬è½¬æ¢ä¸ºå¯ä»¥æ­£ç¡®æ˜¾ç¤ºçš„markdownæ ¼å¼ï¼Œä½¿ç”¨ç»„ä»¶towxml
  set_article(){
    var CN_Stu = "# é˜¿ä¼¯ä¸å­¦é™¢æ´»åŠ¨ç©ºé—´ä½¿ç”¨è§„åˆ™\n\n### ä¸€ã€æ€»åˆ™\n\n1. é˜¿ä¼¯ä¸å­¦ç”Ÿæ´»åŠ¨ç©ºé—´åŒ…æ‹¬è¡Œæ”¿æ¥¼ 104 å­¦ç”Ÿåˆ›æ–°ç©ºé—´å’Œè¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒã€‚\n2. è¡Œæ”¿æ¥¼ 104 å­¦ç”Ÿåˆ›æ–°ç©ºé—´æ˜¯å­¦é™¢ä¸ºå­¦ç”Ÿå­¦ä¹ æä¾›çš„åœºæ‰€ï¼Œä¸»è¦ç”¨äºå­¦ç”Ÿè‡ªä¹ ã€å°ç»„è®¨è®ºç­‰å­¦ä¹ æ´»åŠ¨ã€‚\n3. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒæ˜¯å­¦é™¢ä¸ºå­¦ç”Ÿæ´»åŠ¨æä¾›çš„åœºæ‰€ï¼Œä¸»è¦ç”¨äºä¸¾è¡Œä¼šè®®ï¼Œä¸¾åŠæ´»åŠ¨ç­‰ã€‚\n4. ä¸¥ç¦åœ¨è¡Œæ”¿æ¥¼104å­¦ç”Ÿåˆ›æ–°ç©ºé—´å’Œè¡Œæ”¿æ¥¼106å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä¸¾è¡Œè¿åå…šå’Œå›½å®¶æ”¿ç­–ã€æ³•è§„æˆ–æ•™è‚²è¡Œæ”¿ä¸»ç®¡éƒ¨é—¨è§„å®šä»¥åŠæ ¡è§„æ ¡çºªçš„æ´»åŠ¨ã€‚\n5. è¡Œæ”¿æ¥¼104å­¦ç”Ÿåˆ›æ–°ç©ºé—´å’Œè¡Œæ”¿æ¥¼106å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨åšæŒæœåŠ¡å¸ˆç”Ÿçš„åŸåˆ™, åŸåˆ™ä¸Šåªä¾›æœ¬é™¢å¸ˆç”Ÿä½¿ç”¨ã€‚\n6. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒçš„ä½¿ç”¨ç”±é˜¿ä¼¯ä¸å­¦é™¢å­¦ç”Ÿä¼šå’Œé˜¿ä¼¯ä¸å­¦é™¢æ´»åŠ¨ç©ºé—´ç®¡ç†å‘˜ç®¡ç†ç»Ÿç­¹è°ƒåº¦ã€‚\n\n### äºŒã€è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå€Ÿç”¨è¦æ±‚\n\n1. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå¯ä¾›å€Ÿç”¨çš„æ—¶é—´ä¸ºå‘¨ä¸€è‡³å‘¨äº” 8:30-22:50ï¼Œå‘¨æœ« 8:30-23:20 ä¸”æœ‰ç®¡ç†å‘˜å€¼ç­çš„æ—¶æ®µã€‚\n2. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒé‡‡ç”¨é¢„çº¦åˆ¶ï¼Œå¯¹å­¦é™¢è€å¸ˆï¼Œå­¦ç”Ÿä¼šï¼Œå›¢å§”ï¼Œç¤¾å›¢ï¼Œå›¢ä½“å¼€æ”¾é¢„çº¦ã€‚ä½¿ç”¨è€…åº”åœ¨æ´»åŠ¨ä¸¾åŠå‰åœ¨å€¼ç­æ—¶é—´åˆ°è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå‘é˜¿ä¼¯ä¸å­¦é™¢æ´»åŠ¨ç©ºé—´ç®¡ç†å‘˜æäº¤é¢„çº¦ç”³è¯·ï¼Œä»¥å…ˆåˆ°å…ˆå¾—ä¸ºåŸåˆ™ã€‚\n3. æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå•æ¬¡é¢„çº¦æ—¶é—´ä¸èƒ½è¶…è¿‡ 3 å°æ—¶ï¼Œæ€»é¢„çº¦æ—¶é•¿ä¸è¶…è¿‡æœ¬å‘¨æ€»æ—¶é•¿çš„ 1/5ã€‚ä½¿ç”¨äººæ•°ä¸å¾—ä½äº 3 äººã€‚\n4. ä½¿ç”¨è€…åº”æŒ‰è§„å®šçš„é¢„çº¦æ—¶é—´è¿›è¡Œæ´»åŠ¨ã€‚åœ¨ä¸å ç”¨å…¶ä½™å·²é¢„çº¦æ—¶é—´æ®µå’Œæœ‰ç‰¹æ®Šç†ç”±çš„å‰æä¸‹ï¼Œä½¿ç”¨è€…å¯åœ¨ç°åœºå»¶é•¿é¢„çº¦çš„æ—¶é—´ã€‚\n\n### ä¸‰ã€è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒçš„ä½¿ç”¨è§„åˆ™\n\n1. æœªé€šè¿‡ä¸Šè¿°é¢„çº¦æµç¨‹è¿›è¡Œé¢„çº¦ï¼Œä»»ä½•äººä¸å¾—æ“…è‡ªä½¿ç”¨è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒã€‚\n2. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨éµå¾ªâ€œè°ä½¿ç”¨ã€è°è´Ÿè´£â€çš„åŸåˆ™ã€‚è¿åä»¥ä¸‹è§„å®šè€…ï¼Œå°†è¿›è¡Œä¸€æ¬¡å…¬ç¤ºè­¦å‘Šï¼Œä¸‰æ¬¡è¿è§„è€…å°†æ°¸ä¹…å–æ¶ˆè¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨æƒã€‚\n3. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨è€…åº”è‡ªè§‰ç»´æŠ¤æ•™å®¤å†…å¤–ç¯å¢ƒå«ç”Ÿï¼Œä¸å¾—ç ´åã€ç§è‡ªä½¿ç”¨ã€å¸¦èµ°å±•æŸœé‡Œçš„ç‰©å“åŠè£…é¥°ç‰©å“ï¼Œçˆ±æŠ¤æ•™å®¤å†…è®¾æ–½ï¼Œä¸å‡†åœ¨æ•™å®¤å†…ä¹±è´´ã€ä¹±ç”»ï¼›ä¸å‡†ç§è‡ªæ‹†å¸ã€åˆ»ç”»æ¡Œæ¤…ï¼Œä¸€ç»å‘ç°è­¦å‘Šä¸€æ¬¡ã€‚\n4. ä½¿ç”¨å¤šåª’ä½“è®¾å¤‡ï¼Œåº”ä¸¥æ ¼æ‰§è¡Œæ“ä½œç¨‹åºï¼Œä¿è¯è®¾å¤‡å®‰å…¨ã€‚ç¦æ­¢ç§è‡ªå®‰è£…æ“ä½œç³»ç»Ÿï¼Œç¦æ­¢ä¸‹è½½æºå¸¦è®¡ç®—æœºç—…æ¯’çš„é™„ä»¶æˆ–ç¨‹åºï¼Œå¦‚æœ‰è®¾å¤‡æŸååˆ™æŸåè€…ç…§ä»·èµ”å¿ã€‚\n5. ä½¿ç”¨è€…åœ¨ä½¿ç”¨åå¤åŸåœºåœ°ï¼Œå…³é—­é—¨çª—ã€ç©ºè°ƒã€ç”µè„‘ã€å…³ç¯ã€æ¸…ç†ç°åœºåƒåœ¾ï¼Œä¿è¯æ•™å®¤å¹²å‡€æ•´æ´ã€‚è¿è€…ä¸€ç»å‘ç°ï¼Œè­¦å‘Šä¸€æ¬¡ã€‚\n7. ä¸Šè¯¾æ—¶é—´å€Ÿç”¨åœºåœ°ï¼Œä¸å¯ä»¥å¤§å£°ä½¿ç”¨éŸ³å“ç­‰è®¾å¤‡ï¼Œé¿å…å½±å“åˆ°åœ¨å­¦é™¢æ¥¼åŠå…¬çš„è€å¸ˆåŠä¸Šè¯¾çš„å­¦ç”Ÿï¼Œè¿è§„è€…è­¦å‘Šä¸€æ¬¡ã€‚\n8. ä½¿ç”¨æ•™å®¤æ—¶é—´å¦‚å‘ç”Ÿå˜æ›´æˆ–é¢„å®šçš„æ•™å®¤ä¸å†ä½¿ç”¨ï¼Œéœ€æå‰é€šçŸ¥è¯¾å®¤ç®¡ç†å‘˜ã€‚å€Ÿç”¨æ•™å®¤è¿Ÿåˆ°åŠå°æ—¶æˆ–æ— æ•…ä¸ä½¿ç”¨è€…ï¼Œè­¦å‘Šä¸€æ¬¡ã€‚\n9. åŸåˆ™ä¸Šä½¿ç”¨è€…ä¸å¾—åœ¨æ•™å®¤å­˜æ”¾ä¸ªäººç”¨å“ï¼Œä¸å¾—æ¶æ„å åº§ã€‚å¦‚å› æœ¬äººé—ç•™è€Œé€ æˆçš„ç‰©å“ä¸¢å¤±ï¼Œè´£ä»»è‡ªè´Ÿã€‚\n10. ä¸€åˆ‡è§£é‡Šæƒå½’é˜¿ä¼¯ä¸æ•°æ®ç§‘å­¦ä¸äººå·¥æ™ºèƒ½å­¦é™¢å­¦ç”Ÿä¼šæ‰€æœ‰ã€‚\nç‚¹å‡»å·¦ä¸Šè§’å…³é—­æ­¤é¡µé¢åˆ™è¡¨ç¤ºæ‚¨å·²çŸ¥æ‚‰è¯¥è§„å®šã€‚\n\n"
    var EN_Stu = "#Title\n###text1\nt###text2"
    var CN_Tea = "# é˜¿ä¼¯ä¸å­¦é™¢æ´»åŠ¨ç©ºé—´ä½¿ç”¨è§„åˆ™\n\n### ä¸€ã€æ€»åˆ™\n\n1. é˜¿ä¼¯ä¸å­¦ç”Ÿæ´»åŠ¨ç©ºé—´åŒ…æ‹¬è¡Œæ”¿æ¥¼ 104 å­¦ç”Ÿåˆ›æ–°ç©ºé—´å’Œè¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒã€‚\n2. è¡Œæ”¿æ¥¼ 104 å­¦ç”Ÿåˆ›æ–°ç©ºé—´æ˜¯å­¦é™¢ä¸ºå­¦ç”Ÿå­¦ä¹ æä¾›çš„åœºæ‰€ï¼Œä¸»è¦ç”¨äºå­¦ç”Ÿè‡ªä¹ ã€å°ç»„è®¨è®ºç­‰å­¦ä¹ æ´»åŠ¨ã€‚\n3. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒæ˜¯å­¦é™¢ä¸ºå­¦ç”Ÿæ´»åŠ¨æä¾›çš„åœºæ‰€ï¼Œä¸»è¦ç”¨äºä¸¾è¡Œä¼šè®®ï¼Œä¸¾åŠæ´»åŠ¨ç­‰ã€‚\n4. ä¸¥ç¦åœ¨è¡Œæ”¿æ¥¼104å­¦ç”Ÿåˆ›æ–°ç©ºé—´å’Œè¡Œæ”¿æ¥¼106å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä¸¾è¡Œè¿åå…šå’Œå›½å®¶æ”¿ç­–ã€æ³•è§„æˆ–æ•™è‚²è¡Œæ”¿ä¸»ç®¡éƒ¨é—¨è§„å®šä»¥åŠæ ¡è§„æ ¡çºªçš„æ´»åŠ¨ã€‚\n5. è¡Œæ”¿æ¥¼104å­¦ç”Ÿåˆ›æ–°ç©ºé—´å’Œè¡Œæ”¿æ¥¼106å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨åšæŒæœåŠ¡å¸ˆç”Ÿçš„åŸåˆ™, åŸåˆ™ä¸Šåªä¾›æœ¬é™¢å¸ˆç”Ÿä½¿ç”¨ã€‚\n6. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒçš„ä½¿ç”¨ç”±é˜¿ä¼¯ä¸å­¦é™¢å­¦ç”Ÿä¼šå’Œé˜¿ä¼¯ä¸å­¦é™¢æ´»åŠ¨ç©ºé—´ç®¡ç†å‘˜ç®¡ç†ç»Ÿç­¹è°ƒåº¦ã€‚\n\n### äºŒã€è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå€Ÿç”¨è¦æ±‚\n\n1. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå¯ä¾›å€Ÿç”¨çš„æ—¶é—´ä¸ºå‘¨ä¸€è‡³å‘¨äº” 8:30-22:50ï¼Œå‘¨æœ« 8:30-23:20 ä¸”æœ‰ç®¡ç†å‘˜å€¼ç­çš„æ—¶æ®µã€‚\n2. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒé‡‡ç”¨é¢„çº¦åˆ¶ï¼Œå¯¹å­¦é™¢è€å¸ˆï¼Œå­¦ç”Ÿä¼šï¼Œå›¢å§”ï¼Œç¤¾å›¢ï¼Œå›¢ä½“å¼€æ”¾é¢„çº¦ã€‚ä½¿ç”¨è€…åº”åœ¨æ´»åŠ¨ä¸¾åŠå‰åœ¨å€¼ç­æ—¶é—´åˆ°è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå‘é˜¿ä¼¯ä¸å­¦é™¢æ´»åŠ¨ç©ºé—´ç®¡ç†å‘˜æäº¤é¢„çº¦ç”³è¯·ï¼Œä»¥å…ˆåˆ°å…ˆå¾—ä¸ºåŸåˆ™ã€‚\n3. æ­£å¸¸æƒ…å†µä¸‹ï¼Œè¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒå•æ¬¡é¢„çº¦æ—¶é—´ä¸èƒ½è¶…è¿‡ 3 å°æ—¶ï¼Œæ€»é¢„çº¦æ—¶é•¿ä¸è¶…è¿‡æœ¬å‘¨æ€»æ—¶é•¿çš„ 1/5ã€‚ä½¿ç”¨äººæ•°ä¸å¾—ä½äº 3 äººã€‚\n4. ä½¿ç”¨è€…åº”æŒ‰è§„å®šçš„é¢„çº¦æ—¶é—´è¿›è¡Œæ´»åŠ¨ã€‚åœ¨ä¸å ç”¨å…¶ä½™å·²é¢„çº¦æ—¶é—´æ®µå’Œæœ‰ç‰¹æ®Šç†ç”±çš„å‰æä¸‹ï¼Œä½¿ç”¨è€…å¯åœ¨ç°åœºå»¶é•¿é¢„çº¦çš„æ—¶é—´ã€‚\n\n### ä¸‰ã€è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒçš„ä½¿ç”¨è§„åˆ™\n\n1. æœªé€šè¿‡ä¸Šè¿°é¢„çº¦æµç¨‹è¿›è¡Œé¢„çº¦ï¼Œä»»ä½•äººä¸å¾—æ“…è‡ªä½¿ç”¨è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒã€‚\n2. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨éµå¾ªâ€œè°ä½¿ç”¨ã€è°è´Ÿè´£â€çš„åŸåˆ™ã€‚è¿åä»¥ä¸‹è§„å®šè€…ï¼Œå°†è¿›è¡Œä¸€æ¬¡å…¬ç¤ºè­¦å‘Šï¼Œä¸‰æ¬¡è¿è§„è€…å°†æ°¸ä¹…å–æ¶ˆè¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨æƒã€‚\n3. è¡Œæ”¿æ¥¼ 106 å…šå›¢å­¦æ´»åŠ¨ä¸­å¿ƒä½¿ç”¨è€…åº”è‡ªè§‰ç»´æŠ¤æ•™å®¤å†…å¤–ç¯å¢ƒå«ç”Ÿï¼Œä¸å¾—ç ´åã€ç§è‡ªä½¿ç”¨ã€å¸¦èµ°å±•æŸœé‡Œçš„ç‰©å“åŠè£…é¥°ç‰©å“ï¼Œçˆ±æŠ¤æ•™å®¤å†…è®¾æ–½ï¼Œä¸å‡†åœ¨æ•™å®¤å†…ä¹±è´´ã€ä¹±ç”»ï¼›ä¸å‡†ç§è‡ªæ‹†å¸ã€åˆ»ç”»æ¡Œæ¤…ï¼Œä¸€ç»å‘ç°è­¦å‘Šä¸€æ¬¡ã€‚\n4. ä½¿ç”¨å¤šåª’ä½“è®¾å¤‡ï¼Œåº”ä¸¥æ ¼æ‰§è¡Œæ“ä½œç¨‹åºï¼Œä¿è¯è®¾å¤‡å®‰å…¨ã€‚ç¦æ­¢ç§è‡ªå®‰è£…æ“ä½œç³»ç»Ÿï¼Œç¦æ­¢ä¸‹è½½æºå¸¦è®¡ç®—æœºç—…æ¯’çš„é™„ä»¶æˆ–ç¨‹åºï¼Œå¦‚æœ‰è®¾å¤‡æŸååˆ™æŸåè€…ç…§ä»·èµ”å¿ã€‚\n5. ä½¿ç”¨è€…åœ¨ä½¿ç”¨åå¤åŸåœºåœ°ï¼Œå…³é—­é—¨çª—ã€ç©ºè°ƒã€ç”µè„‘ã€å…³ç¯ã€æ¸…ç†ç°åœºåƒåœ¾ï¼Œä¿è¯æ•™å®¤å¹²å‡€æ•´æ´ã€‚è¿è€…ä¸€ç»å‘ç°ï¼Œè­¦å‘Šä¸€æ¬¡ã€‚\n7. ä¸Šè¯¾æ—¶é—´å€Ÿç”¨åœºåœ°ï¼Œä¸å¯ä»¥å¤§å£°ä½¿ç”¨éŸ³å“ç­‰è®¾å¤‡ï¼Œé¿å…å½±å“åˆ°åœ¨å­¦é™¢æ¥¼åŠå…¬çš„è€å¸ˆåŠä¸Šè¯¾çš„å­¦ç”Ÿï¼Œè¿è§„è€…è­¦å‘Šä¸€æ¬¡ã€‚\n8. ä½¿ç”¨æ•™å®¤æ—¶é—´å¦‚å‘ç”Ÿå˜æ›´æˆ–é¢„å®šçš„æ•™å®¤ä¸å†ä½¿ç”¨ï¼Œéœ€æå‰é€šçŸ¥è¯¾å®¤ç®¡ç†å‘˜ã€‚å€Ÿç”¨æ•™å®¤è¿Ÿåˆ°åŠå°æ—¶æˆ–æ— æ•…ä¸ä½¿ç”¨è€…ï¼Œè­¦å‘Šä¸€æ¬¡ã€‚\n9. åŸåˆ™ä¸Šä½¿ç”¨è€…ä¸å¾—åœ¨æ•™å®¤å­˜æ”¾ä¸ªäººç”¨å“ï¼Œä¸å¾—æ¶æ„å åº§ã€‚å¦‚å› æœ¬äººé—ç•™è€Œé€ æˆçš„ç‰©å“ä¸¢å¤±ï¼Œè´£ä»»è‡ªè´Ÿã€‚\n10. ä¸€åˆ‡è§£é‡Šæƒå½’é˜¿ä¼¯ä¸æ•°æ®ç§‘å­¦ä¸äººå·¥æ™ºèƒ½å­¦é™¢å­¦ç”Ÿä¼šæ‰€æœ‰ã€‚\nç‚¹å‡»å·¦ä¸Šè§’å…³é—­æ­¤é¡µé¢åˆ™è¡¨ç¤ºæ‚¨å·²çŸ¥æ‚‰è¯¥è§„å®šã€‚\n\n"
    var EN_Tea = "#Title\n###text1\nt###text2" 
    var CN_Edu = "???"
    const app = getApp()
    var result_CN_Stu = app.towxml(CN_Stu,'markdown')
    var result_EN_Stu = app.towxml(EN_Stu,'markdown')
    var result_CN_Tea = app.towxml(CN_Tea,'markdown')
    var result_EN_Tea = app.towxml(EN_Tea,'markdown')
    var result_CN_Edu = app.towxml(CN_Edu,'markdown')
    this.setData({
      article_cn_stu: result_CN_Stu,
      article_en_stu: result_EN_Stu,
      article_cn_tea: result_CN_Tea,
      article_en_tea: result_EN_Tea,
      article_cn_edu: result_CN_Edu
    })
  },

  // ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åŠ è½½
  onLoad(options) {
    // è·å–ç”¨æˆ·çš„æƒé™ä¿¡æ¯ï¼Œèµ‹å€¼ç»™credit
    try{
      var temp_credit = wx.getStorageSync("Credit")
      this.setData({
        credit: temp_credit
      })
    }catch(e){
      console.log("æƒé™è·å–é”™è¯¯")
    }
    
    // è·å–ç”¨æˆ·çš„è¯­è¨€ä¿¡æ¯ï¼Œèµ‹å€¼ç»™language
    try{
      var temp_language = wx.getStorageSync("language")
      this.setData({
        language: temp_language
      })
    }catch(e){
      console.log("æƒé™è·å–é”™è¯¯")
    }

    // è·å–æ•™å¸ˆåˆ—è¡¨ä¸æ—¶é—´è¡¨ä¿¡æ¯
    this.getTableDataBase()

    // è®¾ç½®ä½¿ç”¨è¯´æ˜æ–‡æœ¬
    this.set_article()

    // ä¸ºäº†é¿å…ä¸ªäººä¿¡æ¯ç•Œé¢è®¾ç½®è¯­è¨€åæ²¡æœ‰æ›´æ–°ï¼Œè°ƒç”¨äº‘çš„è¯­è¨€ä¿¡æ¯
    wx.cloud.callFunction({
      name: "getLanguage",
      success:res=>{
        this.setData({
          language: res.result.language
        })
      }
    })
  },

  
  // ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢åˆæ¬¡æ¸²æŸ“å®Œæˆ
  onReady() {

  },

  
  //ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢æ˜¾ç¤º
  onShow() {
    // è·å–æ•™å¸ˆåˆ—è¡¨ä¸æ—¶é—´è¡¨ä¿¡æ¯
    this.getTableDataBase()
    // ä¸ºäº†é¿å…ä¸ªäººä¿¡æ¯ç•Œé¢è®¾ç½®è¯­è¨€åæ²¡æœ‰æ›´æ–°ï¼Œè°ƒç”¨ç¼“å­˜è¯­è¨€ä¿¡æ¯çš„åŒæ—¶è°ƒç”¨äº‘æ•°æ®åº“çš„è¯­è¨€ä¿¡æ¯
    wx.getStorageSync('language')
    wx.cloud.callFunction({
      name: "getLanguage",
      success:res=>{
        this.setData({
          language: res.result.language
        })
      }
    })
  },

  //ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢éšè—
  onHide() {

  },

  //ç”Ÿå‘½å‘¨æœŸå‡½æ•°--ç›‘å¬é¡µé¢å¸è½½
  onUnload() {

  },

  // é¡µé¢ç›¸å…³äº‹ä»¶å¤„ç†å‡½æ•°--ç›‘å¬ç”¨æˆ·ä¸‹æ‹‰åŠ¨ä½œ
  // ä¸‹æ‹‰åˆ·æ–°åŠŸèƒ½
  onPullDownRefresh() {
    // è·å–æ•™å¸ˆåˆ—è¡¨ä¸æ—¶é—´è¡¨ä¿¡æ¯
    this.getTableDataBase()
    // åœæ­¢åˆ·æ–°åŠ¨ç”»æ¼”ç¤º
    wx.stopPullDownRefresh()
    // åŠ è½½ä¸­ç•Œé¢Off
  },

  // é¡µé¢ä¸Šæ‹‰è§¦åº•äº‹ä»¶çš„å¤„ç†å‡½æ•°
  onReachBottom() {

  },

  // ç”¨æˆ·ç‚¹å‡»å³ä¸Šè§’åˆ†äº«
  onShareAppMessage() {

  }
})